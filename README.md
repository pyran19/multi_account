# 複数アカウントにおけるレートマッチング参加戦略

## 概要
あるゲームではEloをベースにしたレート戦が行われており、終了時の瞬間レートが評価される。また複数アカウントで参加した場合は所有しているアカウントのうち最もレートの大きいアカウントが採用される慣習である。この時、レート戦への参加戦略により最終レートの期待値が変化しうるか、変化する場合どの程度の変動がありうるか調査したい。

## レート参加のルール
- プレイヤーは以下のいずれかを行う。
    - 所有しているアカウントのうちいずれかでレート戦に参加する
    - レート戦への参加を終了し、レートを確定する  
- 今回のレート変動についてはEloのレートシステムを完全に再現するわけではなく、次のようなモデルで評価する。
    - レート戦に参加すると、ランダムに勝敗が決まり、結果に応じてそのアカウントのレートがプラスかマイナスに変動する。変動値は固定値16変化する
    - プレイヤーは適正レートを持っており、勝率は50%-比例定数*(現在レート-適正レート)で表される。つまり期待値的にはどのアカウントも適正レートに収束する。
    - 複数アカウントを運用する場合、それぞれのアカウントは個別にレートを保持しており、勝率のそれぞれのアカウントで個別に上下させる。適正レートは共通の定数であり、その結果として各アカウントの収束先は同じレートに収束する。
    - 初期レートから適正レート近傍へ向かう際の振る舞いと適正レート周辺での揺らぎの振る舞いは違い、今回は後者についての議論なため、前者は単純化して扱う。それぞれのアカウントは固定値N0回かけて初期レートから適正レートへ移動し、その後上記で書いたような適正レート周辺のランダム揺らぎを開始する。
- プレイヤーの参加戦略については以下のような制約がかかっている。
    - プレイ開始時にレート戦への最大参加回数が設定されており、全てのアカウントの参加回数合計がそこに到達した時点で強制的に終了とする。到達前に終了することは可能
    - 終了時の各アカウントのレートのうち最も大きいアカウントのレートを最終レートとして採用し、最終レートの期待値が大きくなる事を目指す。
## 考察方法
- 逐次解法により期待値を理論的に計算する。
    - 残り試合数n=0の時は最大のレートを持っているアカウントのレートがそのまま期待値。
    - 残り試合数n+1の期待値は勝敗に応じて残りｎの期待値の線形結合で書ける
    - n=0から逐次的に計算することで任意の試合数に対して期待値を評価可能
    - 計算結果の期待値を可視化して考察する。特にｎに対してどのような関数になるかは重要

- 理論値の検証として期待値の逐次計算とはシミュレーションによりレートの増減が期待値通りに行われるかを確認するシミュレーションも行う。
    - アカウントの数だけレートを持つレート列を用意して参加するアカウント決定のアルゴリズムに従ってアカウントを決定。乱数でそのアカウントのレートの増加or減少を決定して変動させるというのを残り試合数Nの分繰り返して最終レートを記録.これを１シーズンとする
    - シーズンを何回も繰り返してアルゴリズムとNごとの平均値を求める。
    - 結果を理論値による期待値と比較

## 解き方の方針


## シミュレーション外の要件
- 本件は研究全体の考察もAIと連携した行う。計算条件を入力として受け取り、その条件におけるシミュレーションを行うプログラムをMCPサーバとして設置し、後程考察用ＬＬＭがＭＣＰからシミュレーションを行いながらレポートを書ける体制を整える。
- 思いつくアルゴリズムをそれぞれ実装しておき、mcpから勝率のレート勾配や適正レート収束までの必要試合数固定値などをmcpから渡して実験することを想定してる。

## フォルダの構成
document/ 文章による問題設定・メモ・清書
- fleeting/ 思いついた内容をそのままメモしたもの
- permanent/ 保存用. プログラム作成のための確定した仕様や設計はここに書く。 また最終的な成果として公開するためのレポートもこちら
- ai/ AI生成の出力物は一旦こちら。ここの内容を元に確定した仕様などはpermanentに移す

src/ シミュレーションのためのコードはこちらに保管する
